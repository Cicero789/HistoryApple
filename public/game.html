<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ChronoQuest â€” Playing</title>
  <link rel="stylesheet" href="/src/css/main.css" />
  <link rel="stylesheet" href="/src/css/game.css" />
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=EB+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=Lato:wght@300;400;700&display=swap" rel="stylesheet" />
</head>
<body class="game-page" id="gameBody">

  <!-- â•â•â• TOP HUD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <header class="game-hud">
    <div class="hud-left">
      <a href="/" class="hud-back" title="Exit to main menu">â³ ChronoQuest</a>
      <div class="hud-chapter" id="hudChapter">Loading...</div>
    </div>
    <div class="hud-stats">
      <div class="stat-item health">
        <span class="stat-icon">â¤ï¸</span>
        <div class="stat-bar-wrap">
          <div class="stat-bar" id="healthBar" style="width:100%"></div>
        </div>
        <span class="stat-val" id="healthVal">100</span>
      </div>
      <div class="stat-item money">
        <span class="stat-icon">ğŸ’°</span>
        <span class="stat-val" id="moneyVal">0</span>
        <span class="stat-unit" id="currencyUnit">coins</span>
      </div>
    </div>
    <div class="hud-right">
      <button class="hud-btn" id="inventoryBtn" title="Inventory">ğŸ’</button>
      <button class="hud-btn" id="glossaryBtn"  title="Glossary">ğŸ“š</button>
      <button class="hud-btn" id="mapBtn"        title="Journey Map">ğŸ—ºï¸</button>
    </div>
  </header>

  <!-- â•â•â• MAIN GAME AREA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <main class="game-main">

    <!-- AI-Generated Scene Image -->
    <div class="scene-image-wrap">
      <div class="scene-image" id="sceneImage"></div>
      <div class="scene-image-overlay"></div>
    </div>

    <!-- Background gradient layer -->
    <div class="scene-bg" id="sceneBg">
      <div class="scene-overlay"></div>
    </div>

    <!-- Game Content -->
    <div class="game-content" id="gameContent">

      <!-- Scene Header -->
      <div class="scene-header">
        <div class="scene-era-badge" id="sceneEra"></div>
        <h2 class="scene-title" id="sceneTitle"></h2>
      </div>

      <!-- Narrative Box -->
      <div class="narrative-box glass" id="narrativeBox">
        <div class="narrative-text" id="narrativeText"></div>
      </div>

      <!-- NPC Dialogue -->
      <div class="npc-dialogue" id="npcDialogue" style="display:none">
        <div class="npc-main">
          <div class="npc-portrait-wrap" id="npcImageWrap" style="display:none">
            <img class="npc-portrait" id="npcPortrait" alt="NPC" />
          </div>
          <div class="npc-text-side">
            <div class="npc-header">
              <span class="npc-avatar" id="npcAvatar">ğŸ§‘</span>
              <span class="npc-name"  id="npcName">NPC</span>
              <button class="talk-to-npc" id="talkToNpc" title="Chat with this character using Grok AI">
                ğŸ¤– Ask Grok AI
              </button>
            </div>
            <div class="npc-speech" id="npcSpeech"></div>
          </div>
        </div>
      </div>

      <!-- Educational Term Popup -->
      <div class="edu-popup glass" id="eduPopup" style="display:none">
        <div class="edu-header">
          <span class="edu-icon">ğŸ“–</span>
          <span class="edu-term" id="eduTerm"></span>
          <button class="edu-close" id="eduClose" title="Close">âœ•</button>
        </div>
        <div class="edu-body" id="eduBody"></div>
      </div>

      <!-- â”€â”€â”€ SCENE TYPE SECTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->

      <!-- Choice Area -->
      <div class="choices-area" id="choicesArea" style="display:none">
        <div class="choices-prompt">What do you do?</div>
        <div class="choices-grid" id="choicesGrid"></div>
      </div>

      <!-- Rest Options -->
      <div class="rest-area" id="restArea" style="display:none">
        <h3 class="section-label">ğŸ•ï¸ Choose where to rest</h3>
        <div class="rest-options" id="restOptions"></div>
      </div>

      <!-- Job / Minigame Area -->
      <div class="minigame-area" id="minigameArea" style="display:none">
        <h3 class="section-label">âš’ï¸ Available Work</h3>
        <div class="job-grid" id="jobGrid"></div>
        <button class="btn-continue" id="continueAfterJob" style="display:none">Continue Journey â†’</button>
      </div>

      <!-- Travel Area -->
      <div class="travel-area" id="travelArea" style="display:none">
        <h3 class="section-label">ğŸ—ºï¸ Choose Your Route</h3>
        <div class="travel-grid" id="travelGrid"></div>
      </div>

      <!-- Quiz Area -->
      <div class="quiz-area glass" id="quizArea" style="display:none">
        <div class="quiz-header">
          <span class="quiz-icon">ğŸ“</span>
          <span class="quiz-title">Knowledge Check</span>
        </div>
        <div class="quiz-question" id="quizQuestion"></div>
        <div class="quiz-options" id="quizOptions"></div>
      </div>

      <!-- Summary Area -->
      <div class="summary-area" id="summaryArea" style="display:none">
        <div class="summary-title">ğŸ“œ Chapter Complete!</div>
        <div class="summary-body" id="summaryBody"></div>
      </div>

      <!-- Setback Area -->
      <div class="setback-area glass" id="setbackArea" style="display:none">
        <div class="setback-header">
          <span class="setback-icon">âš ï¸</span>
          <h3 class="setback-title" id="setbackTitle">Setback!</h3>
        </div>
        <div class="setback-text" id="setbackText"></div>
        <div class="setback-lesson glass" id="setbackLesson"></div>
        <button class="btn-retry" id="setbackRetry">â† Try Again</button>
      </div>

      <!-- Continue Button -->
      <div class="continue-area" id="continueArea" style="display:none">
        <button class="btn-continue" id="continueBtn">Continue â†’</button>
      </div>

    </div><!-- /game-content -->
  </main>

  <!-- â•â•â• TOAST NOTIFICATIONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- â•â•â• AI CHAT MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="modal-overlay" id="chatModal" style="display:none">
    <div class="modal chat-modal glass">
      <div class="chat-header">
        <span class="chat-icon">ğŸ¤–</span>
        <span class="chat-title" id="chatNpcName">Chat with NPC</span>
        <span class="chat-powered">Powered by Grok AI</span>
        <button class="modal-close" id="chatClose">âœ•</button>
      </div>
      <div class="chat-messages" id="chatMessages"></div>
      <div class="chat-input-wrap">
        <input type="text" class="chat-input" id="chatInput"
               placeholder="Ask this character anything about their world..." 
               autocomplete="off" />
        <button class="chat-send" id="chatSend">Send</button>
      </div>
      <div class="chat-disclaimer">AI responses are historically informed but not guaranteed accurate. Use as a learning tool.</div>
    </div>
  </div>

  <!-- â•â•â• INVENTORY MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="modal-overlay" id="inventoryModal" style="display:none">
    <div class="modal inventory-modal glass">
      <div class="modal-header">
        <h2>ğŸ’ Your Pack</h2>
        <button class="modal-close" id="inventoryClose">âœ•</button>
      </div>
      <div class="inventory-items" id="inventoryItems"></div>
    </div>
  </div>

  <!-- â•â•â• GLOSSARY MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="modal-overlay" id="glossaryModal" style="display:none">
    <div class="modal glossary-modal glass">
      <div class="modal-header">
        <h2>ğŸ“š Historical Glossary</h2>
        <button class="modal-close" id="glossaryClose">âœ•</button>
      </div>
      <div class="glossary-list" id="glossaryList"></div>
    </div>
  </div>

  <!-- â•â•â• MAP MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="modal-overlay" id="mapModal" style="display:none">
    <div class="modal map-modal glass">
      <div class="modal-header">
        <h2>ğŸ—ºï¸ Journey Map</h2>
        <button class="modal-close" id="mapClose">âœ•</button>
      </div>
      <div class="map-content" id="mapContent"></div>
    </div>
  </div>

  <script src="/src/js/game.js"></script>
</body>
</html>
